<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exercise 4 - Attendance Report</title>
<link rel="stylesheet" href="css/style.css">
</head>
<body>

<h1>Exercise 4 - Attendance Report</h1>
<a href="exercise3.html">Back: Add Student (Exercise 3)</a>

<table id="attendanceTable">
    <thead>
        <tr><th>Last Name</th><th>First Name</th><th>Absences</th><th>Participation</th></tr>
    </thead>
    <tbody>
        <tr><td>Ahmed</td><td>Sara</td><td>5</td><td>1</td></tr>
        <tr><td>Yacine</td><td>Ali</td><td>1</td><td>4</td></tr>
        <tr><td>Houcine</td><td>Rania</td><td>4</td><td>2</td></tr>
    </tbody>
</table>

<button id="showReportBtn">Show Report</button>
<div id="report">
    <p>Total Students: <span id="totalStudents"></span></p>
    <p>Students Present: <span id="studentsPresent"></span></p>
    <p>Students Participated: <span id="studentsParticipated"></span></p>
    <canvas id="reportChart"></canvas>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.getElementById('showReportBtn').addEventListener('click', function(){
    const table = document.getElementById('attendanceTable').tBodies[0];
    const total = table.rows.length;
    let present = 0, participated = 0;
    for(let row of table.rows){
        if(parseInt(row.cells[2].textContent) === 0) present++;
        if(parseInt(row.cells[3].textContent) > 0) participated++;
    }
    document.getElementById('totalStudents').textContent = total;
    document.getElementById('studentsPresent').textContent = present;
    document.getElementById('studentsParticipated').textContent = participated;

    const ctx = document.getElementById('reportChart').getContext('2d');
    new Chart(ctx,{
        type:'bar',
        data:{
            labels:['Total Students','Present','Participated'],
            datasets:[{
                label:'Attendance Report',
                data:[total,present,participated],
                backgroundColor:['#007bff','#28a745','#ffc107']
            }]
        },
        options:{responsive:true,scales:{y:{beginAtZero:true,precision:0}}}
    });
});
</script>

</body>
</html>
